
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-8.1.3">
    
    
      
        <title>The SeqLike Object - SeqLike</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/apidocs.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-seqlike-object" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SeqLike" class="md-header__button md-logo" aria-label="SeqLike" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SeqLike
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The SeqLike Object
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/modernatx/seqlike" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    modernatx/seqlike
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SeqLike" class="md-nav__button md-logo" aria-label="SeqLike" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    SeqLike
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/modernatx/seqlike" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    modernatx/seqlike
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        SeqLike: Flexible Biological Sequence Objects in Python
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../devcontainer/" class="md-nav__link">
        Development Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../development-environment/" class="md-nav__link">
        Setting up your development environment manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/" class="md-nav__link">
        Documentation Standards and Practices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../import-speed/" class="md-nav__link">
        Optimizing for Import Speed
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The SeqLike Object
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        The SeqLike Object
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#purpose-of-this-document" class="md-nav__link">
    Purpose of this document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike-object-overview" class="md-nav__link">
    SeqLike Object Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-the-constructor-works" class="md-nav__link">
    How the constructor works
  </a>
  
    <nav class="md-nav" aria-label="How the constructor works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#god-mode-when-the-sequence-is-a-seqlike-object" class="md-nav__link">
    God-Mode: When the sequence is a SeqLike object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determine-the-sequence-type" class="md-nav__link">
    Determine the Sequence Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determine-the-alphabet" class="md-nav__link">
    Determine the alphabet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-encoder-objects" class="md-nav__link">
    Create the encoder objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-seqrecord-creation" class="md-nav__link">
    Handle seqrecord creation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-between-nt-and-aa" class="md-nav__link">
    Conversion between NT and AA
  </a>
  
    <nav class="md-nav" aria-label="Conversion between NT and AA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-semantics-of-aa-and-nt-vs-translate-and-back_translate" class="md-nav__link">
    The semantics of .aa() and .nt() vs. .translate() and .back_translate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqrecord-like-behaviour-with-seqlike-attributes" class="md-nav__link">
    SeqRecord-like behaviour with SeqLike attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slicing-behaviour" class="md-nav__link">
    Slicing Behaviour
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-notes" class="md-nav__link">
    Code Notes
  </a>
  
    <nav class="md-nav" aria-label="Code Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-functions" class="md-nav__link">
    Validation functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/mutations/" class="md-nav__link">
        Mutations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/sequence-like/" class="md-nav__link">
        Sequence like
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/align_commandline/" class="md-nav__link">
        Alignment Command-Line Bridge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/alignment_commands/" class="md-nav__link">
        Alignment Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/alignment_utils/" class="md-nav__link">
        Alignment Utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/alphabets/" class="md-nav__link">
        Alphabets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/codon_tables/" class="md-nav__link">
        Codon Tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/draw_utils/" class="md-nav__link">
        Drawing Utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/encoders/" class="md-nav__link">
        Encoders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/seqlike/" class="md-nav__link">
        SeqLike API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/seqlike_accessor/" class="md-nav__link">
        SeqLike Accessor API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#purpose-of-this-document" class="md-nav__link">
    Purpose of this document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike-object-overview" class="md-nav__link">
    SeqLike Object Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-the-constructor-works" class="md-nav__link">
    How the constructor works
  </a>
  
    <nav class="md-nav" aria-label="How the constructor works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#god-mode-when-the-sequence-is-a-seqlike-object" class="md-nav__link">
    God-Mode: When the sequence is a SeqLike object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determine-the-sequence-type" class="md-nav__link">
    Determine the Sequence Type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determine-the-alphabet" class="md-nav__link">
    Determine the alphabet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-encoder-objects" class="md-nav__link">
    Create the encoder objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-seqrecord-creation" class="md-nav__link">
    Handle seqrecord creation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-between-nt-and-aa" class="md-nav__link">
    Conversion between NT and AA
  </a>
  
    <nav class="md-nav" aria-label="Conversion between NT and AA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-semantics-of-aa-and-nt-vs-translate-and-back_translate" class="md-nav__link">
    The semantics of .aa() and .nt() vs. .translate() and .back_translate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqrecord-like-behaviour-with-seqlike-attributes" class="md-nav__link">
    SeqRecord-like behaviour with SeqLike attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slicing-behaviour" class="md-nav__link">
    Slicing Behaviour
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-notes" class="md-nav__link">
    Code Notes
  </a>
  
    <nav class="md-nav" aria-label="Code Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-functions" class="md-nav__link">
    Validation functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/modernatx/seqlike/edit/master/docs/development/seqlike-object.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="the-seqlike-object">The SeqLike Object</h1>
<h2 id="purpose-of-this-document">Purpose of this document</h2>
<p>The purpose of this document is to accurately document the SeqLike object's intended behaviour.
It is not a replacement for docstrings,
which serve as a reference for the arguments of the SeqLike methods.</p>
<p>You should read this document if:</p>
<ol>
<li>You are interested in understanding the internals of how the SeqLike object is organized.</li>
<li>You wish to leverage that knowledge to suggest improvements.</li>
</ol>
<p>What is explicitly out-of-scope for this document are:</p>
<ol>
<li>Places that we need help (please consult code for TODOs)</li>
</ol>
<h2 id="seqlike-object-overview">SeqLike Object Overview</h2>
<p>The SeqLike object aims to be an omnibus object
that can accept any kind of biological sequence-like Python data types.
This means strings, BioPython <code>Seq</code> or <code>SeqRecord</code> objects,
NumPy arrays (and their almost equivalent PyTorch tensors),
and more importantly, other SeqLike objects.</p>
<p>Internal to SeqLike objects are a few key attributes
that control their behaviour.</p>
<p>Firstly, we maintain a dual representation of nucleotides and amino acids
as BioPython SeqRecord objects. These are <code>._aa_record</code> and <code>._nt_record</code>,
as well as a pointer <code>._seqrecord</code> that points to only one of the two.</p>
<p>Secondly, we maintain state identifying whether a SeqLike object
is an <em>amino acid</em> <code>_type</code> or a <em>nucleotide</em> <code>_type</code>.
(Though we use the term "type" here,
please don't confuse it with Python object types!)</p>
<p>Thirdly, there is an <code>alphabet</code> attribute.</p>
<p>The <code>alphabet</code> identifies the set of valid characters
that can exist inside the sequence,
Order matters for the alphabet!</p>
<p>There is also an <code>_index_encoder</code> and <code>_onehot_encoder</code> attribute that gets set,
which allow us to easily take a string sequence
and convert it into a starter numerical representation for downstream purposes
(e.g. as inputs to ML models).</p>
<p>Finally, there is a <code>codon_map</code> attribute that gets set.
Setting this allows us to perform back translation
from amino acid sequences to nucleotid sequences easily.</p>
<p>The main arguments to the SeqLike object constructor are:</p>
<ul>
<li><code>sequence</code>: A SeqLike Type object.</li>
<li><code>seq_type</code>: An optional argument that sets the primary <code>._type</code> of the SeqLike object.</li>
<li><code>alphabet</code>: The set of valid characters for the biological sequence.
We provide a standard set that users can use
in the top-level <code>seqlike</code> namespace and strongly recommend sticking to them.</li>
<li><code>codon_map</code>: An optional argument that enables back-translation.</li>
</ul>
<p>In summary, the main attributes are:</p>
<ul>
<li><code>._aa_record</code>: A BioPython SeqRecord object.</li>
<li><code>._nt_record</code>: A BioPython Seqrecord object.</li>
<li><code>._seqrecord</code>: A BioPython SeqRecord object,
which is always a pointer to one of <code>._aa_record</code> and <code>._nt_record</code>.</li>
<li><code>._type</code>: Primary sequence type. A string, one of <code>("NT", "AA")</code></li>
<li><code>.alphabet</code>: A string of valid characters for the sequence.</li>
<li><code>._index_encoder</code>/<code>._onehot_encoder</code>: An encoder function
for converting the string into a numerical representation.</li>
<li><code>.codon_map</code>: A callable (i.e. function)
that accepts and returns an AA SeqLike object.</li>
</ul>
<h2 id="how-the-constructor-works">How the constructor works</h2>
<p>The <code>seqlike</code> package provides the <code>SeqLike</code> class,
which is used for constructing SeqLike objects.
In the constructor, the <code>seq_type</code> argument is required
in order to avoid incorrectly inferring whether a sequence
is a nucleotide or amino acid sequence.
For convenience, there are also <code>aaSeqLike</code> and <code>ntSeqLike</code> factory functions
that return a SeqLike constructed with the appropriate <code>seq_type</code> specified.
Inside the SeqLike object's constructor,
we use a dispatching pattern that returns a tuple of attributes
based on the Python object types that are passed in.
This design choice is highly inspired by the dispatching pattern
prevalent in the Julia language,
which makes reasoning about the behaviour of the constructor much easier.
It also makes the code flatter and easier to read.
(Zen of Python, friends!)
The main function that determines SeqLike attribute values
is called <code>_construct_seqlike</code>.
At a high level, this is what happens inside <code>_construct_seqlike</code>:</p>
<ol>
<li>We determine the <code>_type</code> and <code>alphabet</code> of the sequence based on the passed-in <code>seq_type</code>, <code>alphabet</code>, and <code>sequence</code> arguments.</li>
<li>We then identify the appropriate <code>_index_encoder</code> and <code>_onehot_encoder</code> to attach to the object based on the <code>alphabet</code>.</li>
<li>We then construct a BioPython SeqRecord object based on the <code>sequence</code>, <code>_index_encoder</code>, and <code>_onehot_encoder</code>.</li>
<li>Finally, we return the SeqLike object attributes to be set.</li>
</ol>
<p>Using this pattern ensures consistency in the way we reason about SeqLike objects.
By using the dispatching pattern,
we can also reason clearly about combinations of cases
and what their intended behaviour ought to be.</p>
<p>Coming up, let's see how some of these cases are handled.</p>
<h3 id="god-mode-when-the-sequence-is-a-seqlike-object">God-Mode: When the sequence is a SeqLike object</h3>
<p>This mode takes top priority.
If a SeqLike object is passed into the SeqLike constructor,
such as what happens in the <code>.nt()</code> and <code>.aa()</code> methods,
then the dispatched constructor function simply copies all relevant attributes
and returns a tuple of them to be set in the object constructor.</p>
<p>Doing so helps with downstream logic;
we never have to worry about the SeqLike object type
in determining how to construct the object.</p>
<!-- TODO: This has to be implemented! -->

<h3 id="determine-the-sequence-type">Determine the Sequence Type</h3>
<p>The <code>._type</code> attribute semantically maps to the "sequence type",
i.e. an amino acid sequence or nucleotide sequence.
This attribute can never be <code>None</code>;
<strong>it must be either "AA" or "NT".</strong></p>
<!-- (NOTE: This should be tested!) -->
<p>We determine <code>._type</code> using two pieces of information:
the <code>seq_type</code> argument and the <code>sequence</code> argument.</p>
<p>Here are the cases that we consider:</p>
<ol>
<li>If <code>seq_type</code> is a string, then <code>._type</code> is set to <code>seq_type</code>.</li>
<li>If <code>seq_type</code> is <code>None</code>, then <code>._type</code> is inferred using the <code>sequence</code> argument.</li>
</ol>
<h3 id="determine-the-alphabet">Determine the alphabet</h3>
<p>Next up, we need to know some information about the sequence's alphabet
in order to determine the encoder mode and the relevant encoders.
Here are a few cases that we handle:</p>
<p>If the alphabet is user-supplied,
our primary assumption is that it is semantically valid for the user's applications.
<em>We don't bother validating the alphabet here!</em>
Otherwise, the alphabet is inferred using <code>seq_type</code> and <code>sequence</code>;
we do our best to map it to one of our supplied alphabets.
We think in most cases, you can simply <em>avoid specifying the alphabet</em>
and trust that our alphabet inference code will do the right thing.</p>
<h3 id="create-the-encoder-objects">Create the encoder objects</h3>
<p>Next up, we need to obtain the encoders!
We maintain dual encoders in SeqLike objects,
one for index encoding and one for one-hot encoding.
These allow us to get array representations of the sequence.
The alphabet order is super duper important here;
it will determine the ordering of one-hot and index encodings.
Here's an example:
if your alphabet is "AUGC" and you ask for an index encoding,
the mappings will be A-&gt;0, U-&gt;1, G-&gt;2 and C-&gt;3.
However, if your alphabet is "AGCU", then
you'll still have A-&gt;0, but G-&gt;1, C-&gt;2 and U-&gt;3.
Try to be sane and stick to the alphabets provided by us :).
The encoders, <code>_onehot_encoder</code> and <code>_index_encoder</code>,
are then both directly created off the alphabet.</p>
<h3 id="handle-seqrecord-creation">Handle seqrecord creation</h3>
<p>Now, we finally handle the sequence object
that will become the _aa_record and/or _nt_record.
The first thing we need to check is if the object type of <code>sequence</code> passed in
is an array-like thing or not.
If it is, we need to convert it back into a <code>str</code> type by way of the encoders
and their <code>inverse_transform</code> methods.
Now, we're ready to turn the <code>sequence</code> into SeqRecord objects.</p>
<p>There is a hierarchy here:</p>
<ul>
<li><code>ArrayType</code> objects are converted into <code>str</code> objects,
which are added to a <code>Seq</code> object inside a <code>SeqRecord</code>.</li>
<li><code>str</code> objects are deep copied and added to a <code>Seq</code>
that is inside a <code>SeqRecord</code> object.</li>
<li><code>Seq</code> objects are deep copied and added to a <code>SeqRecord</code> object.</li>
<li><code>SeqRecord</code> objects are directly deep copied.</li>
</ul>
<p>We can decompose this into a logical information flow
that roughly follows our constructor implementation:</p>
<pre><code>ArrayType -&gt; str -&gt; Seq -&gt; SeqRecord
</code></pre>
<p>In essence, if we start with an <code>ArrayType</code>,
then we call the ArrayType-dispatched function,
and return the string representation.
We then take the string-dispatched function
and return the Seq representation.
And so on and so-forth.
All of this is handled by dispatching on a single function <code>record_from</code>.
(If you're not familiar with what dispatching is,
this is inspired from the Julia language.
We use the <code>multipledispatch</code> library to handle dispatching,
check out its repository <a href="https://github.com/mrocklin/multipledispatch">here</a>
to read more about it.)</p>
<p>By using dispatching, we ensure that whatever data type is passed in for <code>sequence</code>
will be handled by the correct function at the correct step,
while also minimizing code duplication inside the constructor.
Now, while we haven't profiled this just yet,
there <em>may</em> be some performance penalty for the nested calls.</p>
<!-- TODO: Do a profiling exercise? -->
<p>Canonically, though, you might be most used to <code>SeqLikes</code>
being one of <code>str</code>, <code>Seq</code>, or <code>SeqRecord</code>,
and that's perfectly logical.
Regardless, you can rest assured that if you pass in any of those three,
the dispatched function will get called at the right place.</p>
<p>Finally, there are other <code>kwargs</code> that are passed into the constructor -
apart from the <code>_index_encoder</code> and <code>_onehot_encoder</code>
that are necessary for converting <code>ArrayType</code>s,
these get fed directly into the <code>SeqRecord</code> constructor.</p>
<h2 id="conversion-between-nt-and-aa">Conversion between NT and AA</h2>
<p>Converting between the nucleotide and amino acid representations of a sequence
is one of the core features that the <code>SeqLike</code> object brings to the table.
(We show in the tutorial notebooks the kind of situations in which
you might want to switch between the two representations.)
As you, the biosequence practitioner might know,
there are tricky situations that we have to worry about,
so we'll go through some of those in detail here.</p>
<h3 id="the-semantics-of-aa-and-nt-vs-translate-and-back_translate">The semantics of <code>.aa()</code> and .<code>nt()</code> vs. <code>.translate()</code> and <code>.back_translate()</code></h3>
<p>You might be tempted to think that
<code>.aa()</code> and <code>.nt()</code> mean <code>.translate()</code> and <code>.back_translate()</code>.
Thankfully (and we mean it!), this is not the case.
Allow us to explain why.
What <code>.nt()</code> or <code>.aa()</code> are supposed to do
is return a deepcopy of the <code>SeqLike</code> object
with the appropriate <code>._type</code>,
<code>._index_encoder</code>,
<code>._onehot_encoder</code>,
and <code>.alphabet</code> attributes set correctly.
It doesn't explicitly do the <code>.translate()</code> or <code>.back_translate()</code> operation.
You can think of <code>.nt()</code> and <code>.aa()</code> as switching between views of the same sequence.</p>
<p>By contrast, <code>.translate()</code> and <code>.back_translate()</code>
are intended to actively (re)compute the internal representations
<code>._nt_record</code> and <code>._aa_record</code>.
Back translation is especially tricky - for the purposes of engineering mRNA,
you might want to have a <em>stochastic</em> back-translation
so that you can generate multiple variants <em>in silico</em>.
Being Pythonistas,
we know from the Zen of Python that <em>explicit is better than implicit</em>.
As such, we believe that changing the internal representation
is something that should be <em>explicitly</em> requested
rather than <em>implicitly</em> done when switching representations.</p>
<p>With all of that said, there <em>is</em> one asymmetry
that we would like to point out.
It is easy to go from a nucleotide representation to an amino acid representation,
if we assume a codon table is present.
It's <em>not</em> easy to go backwards, because the process is probabilistic:
multiple NT representations could be valid for the same AA representation.
Regardless, <code>.aa()</code> has an argument, <code>auto_translate</code>,
which is set to <code>True</code> by default,
and <code>.nt()</code> has an argument, <code>auto_back_translate</code>,
which is set to <code>True</code> by default.
Consider it our way of providing magic to ourselves and to our users!</p>
<h2 id="seqrecord-like-behaviour-with-seqlike-attributes">SeqRecord-like behaviour with SeqLike attributes</h2>
<p>For users who are used to BioPython SeqRecord objects,
we have implemented a custom <code>__getattr__</code>
that delegates attribute access to the underlying SeqRecord object
that is stored in either the <code>._nt_record</code> (for "NT" SeqLikes) attribute
or the <code>._aa_record</code> (for "AA" SeqLikes) attribute
when one asks for a SeqRecord attribute.</p>
<p>The overall effect here is that we can access SeqRecord attributes
<em>as if</em> they were native to SeqLike objects even though their access is delegated,
such as accessing the SeqRecord's <code>description</code> or <code>dbxrefs</code>.</p>
<pre><code class="language-python">s = SeqLike(&quot;AMPELQYTV&quot;, seq_type=&quot;AA&quot;, alphabet=STANDARD_AA)
s.description  # a SeqRecord attribute accessed on a SeqLike object.
s.dbxrefs      # also a SeqRecord attribute
</code></pre>
<h2 id="slicing-behaviour">Slicing Behaviour</h2>
<p>When we slice into a SeqLike object,
we basically are slicing into the underlying SeqRecord object.
To do so, we have implemented a custom <code>__getitem__</code> method
that guarantees correct slicing behaviour w.r.t.:</p>
<ol>
<li>the underlying SeqRecord object(s) (<code>._nt_record</code> and <code>._aa_record</code>), and</li>
<li>the SeqRecord <code>.letter_annotations</code> dictionaries,</li>
</ol>
<h2 id="code-notes">Code Notes</h2>
<h3 id="validation-functions">Validation functions</h3>
<p>Our validation functions should <em>never, ever, ever</em> return anything.
They should error loudly if the validation check errors out or else be silent.
We will be utterly confused reading the code
if a validation function ever returns anything,
so please don't do that!</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../import-speed/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Optimizing for Import Speed" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Optimizing for Import Speed
            </div>
          </div>
        </a>
      
      
        
        <a href="../versioning/" class="md-footer__link md-footer__link--next" aria-label="Next: Versioning" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Versioning
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant", "tabs"], "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>